<!doctypehtml><meta charset=utf-8><title>InstantPhoto - Server</title><script src=/socket.io/socket.io.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/downloadjs/1.4.8/download.js></script><script src=https://cdn.jsdelivr.net/gh/gitbrent/pptxgenjs@2.5.0/dist/pptxgen.bundle.js></script><div style="margin:0 auto;padding:auto;top:50%;align-content:center;text:center;width:100%;height:90%"class=container id=init><button id=init-button onclick=checkRoomInitialize() style=width:250px;height:30px;position:relative type=button>Click here to start!</button></div><div style=display:none class=container id=main><div style=display:none class=btn-container id=btn-container><button id=clrtmb onclick=rmtmb() style=float:right;position:relative;width:150px;height:25px type=button>Clear Thumbnail</button> <button id=changeroom onclick=joinroom() style=float:right;position:relative;width:110px;height:25px type=button>Change Room</button></div><button id=moreopt onclick=moreopt() style=float:right;position:relative;width:110px;height:25px type=button>More Options</button> <button id=saveimage onclick=saveimage() style=float:right;position:relative;width:130px;height:25px type=button>Save Image : <span id=wannasavemou>Yes</span></button> <button id=togglepptx onclick=togglepptx() style=float:right;position:relative;width:130px;height:25px type=button>Create PPTX : <span id=pptxgenjsstatus>Off</span></button> <button id=savepptx onclick=savepptx() style=float:right;position:relative;width:100px;height:25px type=button disabled>Save PPTX</button><form style=float:right;position:relative><input disabled id=e-warranty style=display:none!important type=file> <input disabled id=GSPNint name=GSPN onkeypress="return formenter(event)"placeholder="S/O number:"></form><span id=ewanstat style=float:right;position:relative;color:green;display:none>✔ E-Warranty Attached ✔</span><h3>Waiting input on client side...</h3><h4>Current room: <span id=roomindicator></span></h4><br><img id=download src=""style=max-width:640px;max-height:480px><div style=position:relative;width:240px;height:720px;float:right id=rightbar></div></div><footer><div style=color:red class=warnings><span id=pptxnotenabled style=display:none>Warning : PPTX not enabled!</span><br><span id=nosaveimage style=display:none>Notice : Image not downloaded!</span></div></footer><script>const svppt=document.getElementById("savepptx"),gpint=document.getElementById("GSPNint"),pptstat=document.getElementById("pptxgenjsstatus"),togppt=document.getElementById("togglepptx"),pptxne=document.getElementById("pptxnotenabled"),fileInput=document.getElementById("e-warranty"),imgdown=document.getElementById("wannasavemou"),nsi=document.getElementById("nosaveimage"),ewanatt=document.getElementById("ewanstat"),btncoint=document.getElementById("btn-container");let pptxenabled=!1,saveimg=!0,optenb=!1;function togglepptx(){window.pptx=new PptxGenJS,pptxenabled=!0,svppt.disabled=!1,gpint.disabled=!1,fileInput.disabled=!1,pptxne.style.display="none",pptstat.innerHTML="On",togppt.disabled=!0}var socket=io(),output=document.getElementById("download"),room="test",rn="0";socket.emit("join",room),socket.on("image",function(a,b){console.log(["receiving data from",b]),output.src=a,triggerthumbnail(a),!0==saveimg?download(a,filename(),"application/octet-stream;base64"):nsi.style.display="block",!0==pptxenabled?(window.slide=pptx.addNewSlide(),slide.addImage({data:a,x:0,y:0,w:9.5,h:5.5})):pptxne.style.display="block"});function filename(){let a=gpint.value;return a}function joinroom(){let a=room;switch(rn++,rn){case 1:room="room1",socket.emit("leave",a),socket.emit("join",room);break;case 2:room="room2",socket.emit("leave",a),socket.emit("join",room);break;case 3:room="room3",socket.emit("leave",a),socket.emit("join",room);break;case 4:room="room4",socket.emit("leave",a),socket.emit("join",room);break;case 5:room="room5",socket.emit("leave",a),socket.emit("join",room);break;case 6:room="room6",socket.emit("leave",a),socket.emit("join",room);break;case 7:alert("You have hit the end of available rooms! Page will now refresh."),location.reload();break;default:room="test";}document.getElementById("roomindicator").innerHTML=room}function checkRoomInitialize(){if(0==rn){var a=document.getElementById("init");a.style.display="none";var b=document.getElementById("main");b.style.display="block",document.getElementById("roomindicator").innerHTML=room}else location.reload()}function savepptx(){gpint&&gpint.value?(pptx.save(filename()),pptstat.innerHTML="Off",pptxenabled=!1,svppt.disabled=!0,gpint.value="",gpint.disabled=!0,togppt.disabled=!1,fileInput.value="",fileInput.disabled=!0,ewanatt.style.display="none",rmtmb()):alert("No GSPN Service Order number!")}function saveimage(){!0===saveimg?(saveimg=!1,imgdown.innerHTML="No",nsi.style.display="block"):!1===saveimg?(saveimg=!0,imgdown.innerHTML="Yes",nsi.style.display="none"):void 0}window.addEventListener("paste",function(a){if(!0==pptxenabled){fileInput.files=a.clipboardData.files;var b=document.querySelector("input[type=file]").files[0],c=new FileReader;c.readAsDataURL(b),c.onloadend=function(){var a=c.result;window.slide=pptx.addNewSlide(),slide.addImage({data:a,x:.5,y:.3,w:8.5,h:5.5}),triggerthumbnail(a)},ewanatt.style.display="block"}else alert("PPTXGenJS not enabled!")});function triggerthumbnail(a){resizeImageToSpecificWidth(200,a,function(a){var b=document.createElement("img");b.src=a,b.setAttribute("id","tmbtnb");var c=document.getElementById("rightbar");c.appendChild(b)})}function resizeImageToSpecificWidth(a,b,c){var d,e=new Image;e.onload=function(){if(e.width>a){var b=document.createElement("canvas"),f=b.getContext("2d");b.width=e.width,b.height=e.height,f.drawImage(e,0,0),e.width>e.height?(b.height=e.height/e.width*a,b.width=a):(b.width=e.width/e.height*a,b.height=a),f.drawImage(b,0,0,b.width,b.height),f.drawImage(e,0,0,b.width,b.height),d=b.toDataURL()}else d=b.toDataURL();c(d)},e.src=b}function formenter(a){a=a||window.event;var b=a.keyCode;if(13==b)return!1}function rmtmb(){var a=document.getElementById("rightbar");a.innerHTML=""}function moreopt(){!0===optenb?(optenb=!1,btncoint.style.display="none"):!1===optenb?(optenb=!0,btncoint.style.display="block"):void 0}window.onload=checkRoomInitialize();</script></html>
